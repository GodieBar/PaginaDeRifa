<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Configuraci칩n b치sica del documento -->
  <meta charset="UTF-8"> <!-- Codificaci칩n de caracteres -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Responsive design -->
  <title>Rifas Diaria</title> <!-- T칤tulo de la p치gina -->

  <!-- Recursos externos -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"> <!-- Fuente Google -->
  <script src="https://sdk.mercadopago.com/js/v2"></script> <!-- SDK de MercadoPago -->
  <link rel="stylesheet" href="style.css"> <!-- Hoja de estilos local -->
</head>
<body>
  <!-- Contenedor principal -->
  <div class="container">
    <!-- Encabezado -->
    <header>
      <h1>游꿀 Rifa Diaria <small>Invierte 20 o 100 pesos MXN y entra al sorteo del d칤a</small></h1>
      <p>춰Hoy puedes ganar entre <strong>3000 y 5000 pesos Mexicanos</strong>!</p>
      <a href="admin.html" class="admin-link">Panel de Vendedor</a> <!-- Enlace al panel de administraci칩n -->
    </header>

    <!-- Formulario de participaci칩n -->
    <form id="raffleForm">
      <!-- Campos de informaci칩n personal -->
      <input type="text" id="name" placeholder="Nombre completo" required>
      <input type="text" id="curp" placeholder="CURP" pattern="^[A-Z]{4}\d{6}[HM][A-Z]{5}[0-9A-Z]{2}$" title="CURP inv치lida. Revisa el formato." required>
      <input type="tel" id="phone" placeholder="Celular (10 d칤gitos)" pattern="[0-9]{10}" required>
      
      <!-- Selecci칩n de monto de participaci칩n -->
      <div class="amount-selection">
        <h3>Selecciona tu participaci칩n:</h3>
        <div class="amount-options">
          <label>
            <input type="radio" name="amount" value="20" checked onchange="updateNumberInputs(1)"> 
            <span>20 MXN - 1 n칰mero</span>
          </label>
          <label>
            <input type="radio" name="amount" value="100" onchange="updateNumberInputs(5)"> 
            <span>100 MXN - 5 n칰meros</span>
          </label>
        </div>
      </div>
      
      <!-- Contenedor din치mico para n칰meros de rifa -->
      <div class="number-inputs" id="numberInputsContainer">
        <!-- Los campos de n칰meros se generan din치micamente con JavaScript -->
        <div class="number-input">
          <input type="text" name="raffleNumber" placeholder="N칰mero de 4 cifras (0000-9999)" 
                 pattern="\d{4}" title="Debe ingresar exactamente 4 d칤gitos" 
                 maxlength="4" required
                 oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 4)">
        </div>
      </div>
      
      <!-- Aceptaci칩n de t칠rminos -->
      <label class="checkbox">
        <input type="checkbox" id="terms" required>
        Acepto t칠rminos y condiciones.
      </label>
      
      <!-- Botones de acci칩n -->
      <button type="submit" id="submitBtn">Participar</button>
      <div id="payment-button" class="hidden"></div> <!-- Contenedor para bot칩n de pago (oculto inicialmente) -->
      <button type="button" id="showNumbersBtn">Ver n칰meros disponibles</button>
    </form>

    <!-- Secci칩n del ganador (oculta inicialmente) -->
    <div id="winnerSection" class="hidden">
      <h2>游끥 Ganador del d칤a</h2>
      <div id="winnerInfo"></div> <!-- Aqu칤 se mostrar치 la informaci칩n del ganador -->
    </div>

    <!-- Contador regresivo para el sorteo -->
    <div class="countdown">
      <p>Sorteo en: <span id="countdown">17:00:00</span></p>
    </div>

    <!-- Listado de ganadores anteriores -->
    <div class="previous-winners">
      <h3>칔ltimos ganadores</h3>
      <ul id="winnerList"></ul> <!-- Lista que se llenar치 din치micamente -->
    </div>
  </div>

  <!-- Modal de t칠rminos y condiciones (oculto inicialmente) -->
  <div id="termsModal" class="modal hidden">
    <div class="modal-content">
      <span class="close">&times;</span> <!-- Bot칩n para cerrar el modal -->
      <h2>T칠rminos y Condiciones</h2>
      <div class="terms-text">
        <p>1. Participaci칩n v치lida solo para mayores de 18 a침os.</p>
        <p>2. El sorteo se realiza diariamente a las 17:00 hrs.</p>
        <p>3. Premios sujetos a verificaci칩n de identidad.</p>
        <p>4. Solo participaciones pagadas ser치n incluidas en el sorteo.</p>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    /**
     * Funci칩n para actualizar din치micamente los campos de n칰meros de rifa
     * @param {number} count - Cantidad de campos a mostrar (1 o 5)
     */
    function updateNumberInputs(count) {
      // Obtiene el contenedor de los campos de n칰meros
      const container = document.getElementById('numberInputsContainer');
      // Limpia cualquier campo existente
      container.innerHTML = '';
      
      // Crea la cantidad especificada de campos de entrada
      for (let i = 0; i < count; i++) {
        const div = document.createElement('div');
        div.className = 'number-input';
        // HTML para cada campo de n칰mero con validaciones
        div.innerHTML = `
          <input type="text" name="raffleNumber" placeholder="N칰mero ${i+1} (0000-9999)" 
                 pattern="\\d{4}" title="Debe ingresar exactamente 4 d칤gitos" 
                 maxlength="4" required
                 oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 4)">
        `;
        // Agrega el campo al contenedor
        container.appendChild(div);
      }
    }
  </script>

  <!-- Scripts externos -->
  <script type="module" src="firebase.js"></script> <!-- Conexi칩n con Firebase -->
  <script type="module" src="script.js"></script> <!-- L칩gica principal de la aplicaci칩n -->
  <script src="mercadopago.js"></script> <!-- Integraci칩n con MercadoPago -->
</body>
</html>